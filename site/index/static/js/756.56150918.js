"use strict";(self["webpackChunksite"]=self["webpackChunksite"]||[]).push([[756],{756:function(e,l,t){t.r(l),t.d(l,{default:function(){return W}});var s=t(3396),a=t(9242),n=t(7139);const i={class:"bg-orange-50 h-screen flex flex-col overflow-auto"},u=(0,s._)("div",{class:"flex-grow min-h-[1em]"},null,-1),o={class:"bg-white sm:shadow p-5 w-full h-screen sm:w-2/3 md:w-96 sm:h-fit mx-auto"},d={class:"text-left"},r=(0,s._)("hr",{class:"mt-3"},null,-1),c={class:"round-input-label"},p=(0,s._)("div",{class:"title"},"請選擇驗證方式",-1),f=(0,s._)("option",{value:"0"},"學校Email信箱驗證",-1),v=(0,s._)("option",{value:"1"},"上傳證明文件",-1),m=[f,v],y=(0,s._)("hr",null,null,-1),w={key:0,class:"w-full"},g={class:"round-input-label"},k=(0,s._)("div",{class:"title"},"學校Email信箱",-1),x=["disabled"],h={key:0},_={key:1},b={key:2},C={key:0,class:"flex text-xl text-gray-500 items-center w-full flex-nowrap box-border"},D={class:"whitespace-nowrap"},H={key:1,class:"text-red-700 text-sm text-left my-1"},z={key:1},V={class:"round-input-label"},q=(0,s._)("div",{class:"title"},"選擇文件",-1),E={type:"file",id:"input",class:"input",ref:"fileElement",accept:"image/png,image/jpg"},T={key:0,class:"text-red-700 text-sm my-1"},S={key:0,class:"text-red-700 text-sm text-left my-1"},U=(0,s._)("div",{class:"text-sm text-gray-500"},[(0,s.Uk)("當您點下上傳，代表您已同意我們的"),(0,s._)("a",{class:"hyperlink"},"隱私權條款")],-1),A=(0,s._)("div",{class:"flex-grow min-h-[2em]"},null,-1);function Z(e,l,t,f,v,Z){const P=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",i,[u,(0,s._)("div",o,[(0,s._)("div",d,[(0,s.Wm)(P,{class:"text-lg hyperlink",to:"/"},{default:(0,s.w5)((()=>[(0,s.Uk)("回上一頁")])),_:1})]),r,(0,s._)("label",c,[p,(0,s.wy)((0,s._)("select",{class:"select","onUpdate:modelValue":l[0]||(l[0]=l=>e.verifyType=l)},m,512),[[a.bM,e.verifyType]])]),y,0==e.verifyType?((0,s.wg)(),(0,s.iD)("div",w,[(0,s._)("label",g,[k,(0,s.wy)((0,s._)("input",{type:"email",class:"input",placeholder:"yourid@univname.edu.tw","onUpdate:modelValue":l[1]||(l[1]=l=>e.email=l),onKeyup:l[2]||(l[2]=(0,a.D2)(((...l)=>e.sendVerifyCode&&e.sendVerifyCode(...l)),["enter"]))},null,544),[[a.nr,e.email]])]),(0,s._)("button",{class:"round-full-button",onClick:l[3]||(l[3]=(...l)=>e.sendVerifyCode&&e.sendVerifyCode(...l)),disabled:!0===e.sendCodeStatus&&e.countdown>0},[!1===e.sendCodeStatus?((0,s.wg)(),(0,s.iD)("span",h,"發送驗證碼")):!0===e.sendCodeStatus&&e.countdown>0?((0,s.wg)(),(0,s.iD)("span",_,(0,n.zw)(e.countdown)+"秒後可發送",1)):((0,s.wg)(),(0,s.iD)("span",b,"重新傳送"))],8,x),!0===e.sendCodeStatus?((0,s.wg)(),(0,s.iD)("div",C,[(0,s._)("div",D,(0,n.zw)(e.prefix)+" -",1),(0,s.wy)((0,s._)("input",{type:"text",maxlength:"6",class:"block border-2 py-1 px-5 w-full ml-2 rounded-full flex-grow","onUpdate:modelValue":l[4]||(l[4]=l=>e.code=l),onKeyup:l[5]||(l[5]=(0,a.D2)(((...l)=>e.verifyCode&&e.verifyCode(...l)),["enter"]))},null,544),[[a.nr,e.code]]),(0,s._)("button",{class:"round-full-button whitespace-nowrap ml-2 w-24",onClick:l[6]||(l[6]=(...l)=>e.verifyCode&&e.verifyCode(...l))},"驗證")])):(0,s.kq)("",!0),null!=e.message?((0,s.wg)(),(0,s.iD)("div",H,(0,n.zw)(e.message),1)):(0,s.kq)("",!0)])):(0,s.kq)("",!0),1==e.verifyType?((0,s.wg)(),(0,s.iD)("div",z,[(0,s._)("label",V,[q,(0,s._)("input",E,null,512),e.sizeError?((0,s.wg)(),(0,s.iD)("div",T,"檔案請小於5MB")):(0,s.kq)("",!0)]),(0,s._)("button",{class:"round-full-button",onClick:l[7]||(l[7]=(...l)=>e.upload&&e.upload(...l))},"上傳"),null!=e.message?((0,s.wg)(),(0,s.iD)("div",S,(0,n.zw)(e.message),1)):(0,s.kq)("",!0),U])):(0,s.kq)("",!0)]),A])}t(7658);var P=t(4870),B=t(65),K=t(2483),M=t(6895),j=t(70),F=(0,s.aZ)({setup(){const e=(0,B.oR)(),l=(0,K.tv)(),t=new M.Z(e.state.token),s=(0,P.iH)(0),a=(0,P.iH)(""),n=(0,P.iH)(""),i=(0,P.iH)(!1),u=(0,P.iH)(0),o=(0,P.iH)(null);let d=!0;function r(){d&&(d=!1,u.value=60,t.Post("auth/user/verify/email",{email:a.value},null,!0,!0).then((e=>{"A01"===e.status&&(n.value=e.prefix,o.value=null,i.value=!0),void 0!==e.message&&(o.value=e.message)})))}const c=(0,P.iH)("");function p(){t.Post("auth/user/verify/email/code",{code:c.value,prefix:n.value},null,!0,!0).then((e=>{"A04"===e.status&&(o.value=null,l.push("/")),void 0!==e.message&&(o.value=e.message)}))}setInterval((()=>{!1===d&&u.value<=0?d=!0:u.value--}),1e3);const f=(0,P.iH)(null),v=(0,P.iH)(!1);function m(){v.value=!1;for(let e=0;e<f.value.files.length;e++)if(f.value.files[e].size>4194304)return void(v.value=!0);const t=new FormData;t.append("image",f.value.files[0]),j.ZP.post("https://sports.nsysu.edu.tw/monkeyserver/api/auth/user/upload",t,{headers:{Authorization:`Bearer ${e.state.token}`,"Content-Type":"multipart/form-data"}}).then((e=>{"A05"===e.data.status&&(alert("上傳成功，請靜候審核"),o.value=null,l.push("/")),void 0!==e.data.message&&(o.value=e.data.message)}))}return{email:a,verifyType:s,sendCodeStatus:i,sendVerifyCode:r,fileElement:f,upload:m,sizeError:v,prefix:n,countdown:u,message:o,code:c,verifyCode:p}}}),I=t(89);const R=(0,I.Z)(F,[["render",Z]]);var W=R}}]);
//# sourceMappingURL=756.56150918.js.map